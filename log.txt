## This document contains an overview of the bugs run into when compiling with different versions of emsdk


1. [X] Review changes to love.js, love-emscripten and megasource-emscripten
2. [X] Pull latest love.js onto my fork of love.js
3. [X] Update 11.5 branch of love-emscripten and love megasource-emscripten to align with love 11.5
4. [X] Diff love.js and 11.4 to get a list of changes, do the same with the megasource
5. [X] Iterte through those changes but this time in the emscripten 11.5 branch
6. Compile using emscripten 2.0 and fix any outstanding compilation errors
7. Make PR to main love.js repo updating it to 11.5
8. Rewrite the core of love.js to use lua rather than node.


megasource: No additional changes required.
love, pull latest davidobot into branch 11.4

I am testing out not modifying SDL 


~/Github/emsdk/emsdk install 2.0.0 &&
~/Github/emsdk/emsdk activate 2.0.0
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk

~/Github/emsdk/emsdk install 2.0.6 &&
~/Github/emsdk/emsdk activate 2.0.6

## 3.1.57
~/Github/emsdk/emsdk install latest &&
~/Github/emsdk/emsdk activate latest &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk

## 3.1.57
~/Github/emsdk/emsdk install 3.1.57 &&
~/Github/emsdk/emsdk activate 3.1.57 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk

## Love 11.5 uses SDL2_VER "2.28.5"
## 3.1.68 - SDL port upgraded to 2.30.8
~/Github/emsdk/emsdk install 3.1.68 &&
~/Github/emsdk/emsdk activate 3.1.68 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk


## 3.1.69 - SDL port upgraded to 2.30.8
~/Github/emsdk/emsdk install 3.1.69 &&
~/Github/emsdk/emsdk activate 3.1.69 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk

## something breaks between 3.1.57 and 3.1.59 Module seems to be unavailable at runtime or we overwrite it with
## our use of module?

~/Github/emsdk/emsdk install 3.1.58 &&
~/Github/emsdk/emsdk activate 3.1.58 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk
## no issue with quick link
## Uncaught (in promise) TypeError: Module.addRunDependency is not a function arises
## 3.1.58 updated how MODULARIZE workes. It used to change the module in place, now it returns an updated module?
## In -sMODULARIZE mode, the argument passed into the module constructor is no longer mutated in place. The expectation is that# the module instance will be available via the constructor return value. Attempting to access methods on the object passed into the constructor will now abort. (#21775)
## https://github.com/emscripten-core/emscripten/pull/21775
## fixed by passing Module as variable into loading function

~/Github/emsdk/emsdk install 3.1.59 &&
~/Github/emsdk/emsdk activate 3.1.59 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk


~/Github/emsdk/emsdk install 3.0.0 &&
~/Github/emsdk/emsdk activate 3.0.0 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk

rm -r build/release/
~/Github/emsdk/emsdk install 3.1.0 &&
~/Github/emsdk/emsdk activate 3.1.0 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk


rm -r build/release/
~/Github/emsdk/emsdk install 3.1.20 &&
~/Github/emsdk/emsdk activate 3.1.20 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk
wasm-ld: error: --shared-memory is disallowed by sfnt.c.o because it was not compiled with 'atomics' or 'bulk-memory' features.

rm -r build/release/
~/Github/emsdk/emsdk install 3.1.40 &&
~/Github/emsdk/emsdk activate 3.1.40 &&
./build_lovejs.sh /home/alexjgriffith/Github/lovejs-update/megasource/ ~/Github/emsdk
## /home/alexjgriffith/Github/emsdk/upstream/bin/llvm-ranlib: error: unable to load 'libz.a': No such file or directory

emcc: warning: linker setting ignored during compilation: 'FULL_ES2' [-Wunused-command-line-argument]
emcc: warning: linker setting ignored during compilation: 'INVOKE_RUN' [-Wunused-command-line-argument]
emcc: warning: linker flag ignored during compilation: '--post-js' [-Wunused-command-line-argument]
em++: warning: linker setting ignored during compilation: 'FULL_ES2' [-Wunused-command-line-argument]
em++: warning: linker setting ignored during compilation: 'INVOKE_RUN' [-Wunused-command-line-argument]
em++: warning: linker flag ignored during compilation: '--post-js' [-Wunused-command-line-argument]

Building C object freetype/CMakeFiles/freetype.dir/src/sfnt/sfnt.c.o
wasm-ld: error: --shared-memory is disallowed by sfnt.c.o because it was not compiled with 'atomics' or 'bulk-memory' features.
em++: error:
## make sure sfnt is built with -sUSE_PTHREAD
